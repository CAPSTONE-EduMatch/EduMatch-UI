type User {
	id: ID!
	name: String!
	email: String!
	image: String
}

type Message {
	id: ID!
	threadId: ID!
	content: String!
	senderId: ID!
	senderName: String!
	senderImage: String
	createdAt: String!
	fileUrl: String
	fileName: String
	mimeType: String
	isRead: Boolean!
	readAt: String
}

type Thread {
	id: ID!
	user1Id: ID!
	user2Id: ID!
	lastMessage: String
	lastMessageAt: String
	lastMessageSenderId: ID
	lastMessageSenderName: String
	lastMessageSenderImage: String
	lastMessageFileUrl: String
	lastMessageFileName: String
	lastMessageMimeType: String
	createdAt: String!
	updatedAt: String!
	unreadCount: Int!
}

type MessageRead {
	id: ID!
	messageId: ID!
	userId: ID!
	readAt: String!
}

input CreateMessageInput {
	threadId: ID!
	content: String!
	fileUrl: String
	fileName: String
	mimeType: String
	senderId: ID
	senderName: String
	senderImage: String
}

input CreateThreadInput {
	participantId: ID!
	userId: ID
	userName: String
	userEmail: String
	userImage: String
}

input MarkMessageReadInput {
	messageId: ID!
	userId: ID
}

input ClearThreadUnreadCountInput {
	threadId: ID!
	userId: ID
}

type Query {
	getThreads(userId: ID): [Thread!]!
	getMessages(threadId: ID!): [Message!]!
	getUnreadCount(userId: ID): Int!
}

type Mutation {
	createMessage(input: CreateMessageInput!): Message!
	createThread(input: CreateThreadInput!): Thread!
	markMessageRead(input: MarkMessageReadInput!): MessageRead!
	clearThreadUnreadCount(input: ClearThreadUnreadCountInput!): Thread!
}

type Subscription {
	onMessageAdded(threadId: ID!): Message
		@aws_subscribe(mutations: ["createMessage"])
	onThreadCreated: Thread @aws_subscribe(mutations: ["createThread"])
}
