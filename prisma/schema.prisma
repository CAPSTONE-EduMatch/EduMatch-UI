generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ==================
// Existing models (unchanged)
// ==================
model User {
  id                                String         @id
  name                              String
  email                             String         @unique
  emailVerified                     Boolean        @default(false)
  image                             String?
  createdAt                         DateTime       @default(now())
  updatedAt                         DateTime       @default(now()) @updatedAt
  stripeCustomerId                  String?
  role                              String?
  banned                            Boolean?       @default(false)
  banReason                         String?
  banExpires                        DateTime?
  Email                             Email[]
  Notification                      Notification[]
  Wishlist                          Wishlist[]
  accounts                          Account[]
  application                       application[]
  mesage                            mesage[]
  profile                           Profile?
  sessions                          Session[]
  thread_thread_createdByToUser     thread[]       @relation("thread_createdByToUser")
  thread_thread_participantIdToUser thread[]       @relation("thread_participantIdToUser")

  role       String?
  banned     Boolean?  @default(false)
  banReason  String?
  banExpires DateTime?

  // Additional relations
  emails              Email[]
  notifications       Notification[]
  wishlists          Wishlist[]
  applications       Application[]
  createdThreads     Thread[] @relation("ThreadCreatedBy")
  participantThreads Thread[] @relation("ThreadParticipant")
  sentMessages       Mesage[]

  @@map("User")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("account")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("session")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now()) @updatedAt

  @@map("verification")
}

model Subscription {
  id                   String    @id
  plan                 String
  referenceId          String
  stripeCustomerId     String?
  stripeSubscriptionId String?
  status               String?
  periodStart          DateTime?
  periodEnd            DateTime?
  cancelAtPeriodEnd    Boolean?  @default(false)
  seats                Int?
  trialStart           DateTime?
  trialEnd             DateTime?

  @@map("subscription")
}

model Message {
  id        String   @id
  text      String
  userName  String
  roomId    String   @default("general")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Message")
}

model Post {
  id        String   @id
  title     String
  content   String?
  published Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  authorId  String

  @@map("Post")
}

model File {
  id           String        @id @default(uuid())
  name         String
  originalName String        @map("originalName")
  key          String        @unique
  bucket       String
  size         Int?
  mimeType     String?       @map("mimeType")
  extension    String?
  category     String        @default("other")
  url          String?
  isPublic     Boolean       @default(false) @map("isPublic")
  metadata     Json?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  userId       String
  folderId     String?
  profileFiles ProfileFile[]

  @@map("file")
}

model Folder {
  id          String   @id
  name        String
  description String?
  path        String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  userId      String
  parentId    String?

  @@map("folder")
}

model Profile {
  id                 String          @id @default(uuid())
  userId             String          @unique
  role               String
  firstName          String
  lastName           String
  gender             String
  birthday           String
  nationality        String
  phoneNumber        String
  countryCode        String
  interests          String[]        @default([])
  favoriteCountries  String[]        @default([])
  profilePhoto       String?
  graduationStatus   String?
  degree             String?
  fieldOfStudy       String?
  university         String?
  graduationYear     String?
  gpa                String?
  countryOfStudy     String?
  scoreType          String?
  scoreValue         String?
  hasForeignLanguage String?
  // Institution fields
  institutionName             String?
  institutionAbbreviation      String?
  institutionHotline           String?
  institutionHotlineCode      String?
  institutionType              String?
  institutionWebsite           String?
  institutionEmail             String?
  institutionCountry           String?
  institutionAddress           String?
  representativeName           String?
  representativeAppellation    String?
  representativePosition       String?
  representativeEmail          String?
  representativePhone          String?
  representativePhoneCode      String?
  aboutInstitution            String?
  institutionDisciplines       String[]        @default([])
  institutionCoverImage        String?
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt
  languages          Language[]
  user               User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  uploadedFiles      ProfileFile[]
  researchPapers     ResearchPaper[]

  @@map("profile")
}

model Language {
  id          String   @id @default(uuid())
  profileId   String
  language    String
  certificate String
  score       String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  profile     Profile  @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@map("language")
}

model ResearchPaper {
  id         String        @id @default(uuid())
  profileId  String
  title      String
  discipline String
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt
  files      ProfileFile[]
  profile    Profile       @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@map("research_paper")
}

model ProfileFile {
  id              String         @id @default(uuid())
  profileId       String?
  researchPaperId String?
  fileId          String
  category        String
  createdAt       DateTime       @default(now())
  file            File           @relation(fields: [fileId], references: [id], onDelete: Cascade)
  profile         Profile?       @relation(fields: [profileId], references: [id], onDelete: Cascade)
  researchPaper   ResearchPaper? @relation(fields: [researchPaperId], references: [id], onDelete: Cascade)

  @@map("profile_file")
}

model Document {
  id                     String                  @id
  bucket                 String
  objectKey              String
  size                   Int
  contentType            String
  metadata               Json
  application_attachment application_attachment?
  profile_attachment     profile_attachment?
}

model Email {
  id       String    @id
  userId   String
  from     String
  to       String
  subject  String
  status   String
  createAt DateTime
  queuedAt DateTime
  read_at  DateTime?
  User     User      @relation(fields: [userId], references: [id], onDelete: NoAction)
}

model Favorite_Subdiscipline {
  profileId       String
  subdisciplineId Int       @default(autoincrement())
  created_at      DateTime  @default(now())
  updateAt        DateTime?

  @@id([profileId, subdisciplineId])
}

model Notification {
  id       String    @id
  userId   String
  type     String
  title    String
  bodyText String
  url      String
  payload  Json
  createAt DateTime
  queuedAt DateTime
  read_at  DateTime?
  status   String
  User     User      @relation(fields: [userId], references: [id], onDelete: NoAction)
}

model Post_job {
  PostId                    String  @id
  contract_type             String
  job_type                  String
  min_salary                Decimal
  max_salary                Decimal
  salary_description        String?
  benefit                   String?
  main_responsibility       String?
  qualification_requirement String?
  experience_requirement    String?
  assessment_criteria       String?
  other_requirement         String?
}

model Post_program {
  PostId           String   @id
  duration         String
  degreeLevel      String
  CourseInclude    String?
  professor_name   String?
  gpa              Decimal?
  gre              Int?
  gmat             Int?
  tuition_fee      Decimal?
  fee_description  String?
  scholarship_info String?
}

model Post_scholarship {
  PostId               String   @id
  detail               String
  type                 String
  number               Int?
  grant                String?
  scholarship_coverage String?
  essay_required       Boolean?
  eligibility          String?
}

model Sub_Discipline {
  id                  Int                   @id @default(autoincrement())
  disciplineId        Int
  name                String
  status              Boolean               @default(true)
  created_at          DateTime              @default(now())
  discipline          discipline            @relation(fields: [disciplineId], references: [id], onDelete: NoAction)
  institution_profile institution_profile[]
}

model Subcription {
  planId              String
  referenceId         String
  stripeCustomerId    String
  stripeSubcriptionId String    @id
  status              String
  periodStart         DateTime?
  periodEnd           DateTime?
  cancelAtPeriodEnd   Boolean?  @default(false)
  trialStart          DateTime?
  trialEnd            DateTime?
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
  plan                plan      @relation(fields: [planId], references: [id], onDelete: NoAction)
}

model Wishlist {
  postId    String
  userId    String
  createdAt DateTime @default(now())
  status    Int
  User      User     @relation(fields: [userId], references: [id], onDelete: NoAction)

  @@id([postId, userId])
}

model application {
  id                     String                   @id
  postId                 String
  applicantId            String
  submittedAt            DateTime
  status                 String
  updateAt               DateTime?
  User                   User                     @relation(fields: [applicantId], references: [id], onDelete: NoAction)
  application_attachment application_attachment[]
}

model application_attachment {
  documentId    String      @id
  applicationId String
  name          String
  description   String
  status        Boolean
  createdAt     DateTime    @default(now())
  application   application @relation(fields: [applicationId], references: [id], onDelete: NoAction)
  Document      Document    @relation(fields: [documentId], references: [id], onDelete: NoAction)
}

model campus {
  id                  Int                 @id @default(autoincrement())
  country             String
  address             String
  status              Boolean
  createAt            DateTime
  updateAt            DateTime            @db.Timestamp(6)
  profileId           String
  institution_profile institution_profile @relation(fields: [profileId], references: [profile_id], onDelete: NoAction)
}

model certificate {
  id              Int             @id @default(autoincrement())
  profile_id      String
  language        String
  score           String
  status          Int
  createdAt       DateTime        @default(now())
  student_profile student_profile @relation(fields: [profile_id], references: [profile_id], onDelete: NoAction)
}

model discipline {
  id             Int              @id @default(autoincrement())
  name           String
  status         Boolean
  createdAt      DateTime         @default(now())
  Sub_Discipline Sub_Discipline[]
}

model institution_profile {
  profile_id      String         @id
  logo            String
  name            String
  abbreviation    String
  hotline         String         @db.VarChar(12)
  type            String
  website         String
  country         String
  address         String
  rep_name        String
  rep_appellation DateTime       @db.Date
  rep_position    String
  rep_email       String
  rep_phone       String
  about           String
  subdiscipline   Int
  cover_image     String
  campus          campus[]
  Sub_Discipline  Sub_Discipline @relation(fields: [subdiscipline], references: [id], onDelete: NoAction)
}

model mesage {
  id        String   @id
  senderId  String
  threadId  String
  body      String
  createdAt DateTime
  User      User     @relation(fields: [senderId], references: [id], onDelete: NoAction)
  thread    thread   @relation(fields: [threadId], references: [id], onDelete: NoAction)
}

model plan {
  id          String        @id
  code        String
  name        String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime
  Subcription Subcription[]
}

model post_file_requirement {
  id          String  @id
  postId      String
  name        String
  description String?
}

model profile_attachment {
  documentId String   @id
  profile_id String
  status     Boolean
  createdAt  DateTime @default(now())
  name       String?
  d_cription String?  @map("d√©cription")
  Document   Document @relation(fields: [documentId], references: [id], onDelete: NoAction)
}

model role {
  id     Int     @id @default(autoincrement())
  name   String
  status Boolean
}

model student_profile {
  profile_id      String        @id
  firstName       String
  LastName        String
  birthDay        DateTime      @db.Date
  gender          Boolean
  phone           String        @db.VarChar(12)
  graduated       Boolean
  university      String?
  degreeLevel     String
  institution     String
  gpa             Decimal
  subDisciplineId BigInt
  fav_country     String?
  certificate     certificate[]
}

model thread {
  id                              String   @id
  createdBy                       String
  participantId                   String
  lastMessageId                   String
  lastMessageAt                   DateTime
  createdAt                       DateTime
  mesage                          mesage[]
  User_thread_createdByToUser     User     @relation("thread_createdByToUser", fields: [createdBy], references: [id], onDelete: NoAction)
  User_thread_participantIdToUser User     @relation("thread_participantIdToUser", fields: [participantId], references: [id], onDelete: NoAction)
}
